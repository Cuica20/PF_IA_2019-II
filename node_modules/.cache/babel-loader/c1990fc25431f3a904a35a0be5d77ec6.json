{"ast":null,"code":"import _objectSpread from \"/Users/datascience/belcorp/repo-pro-12/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport _regeneratorRuntime from \"/Users/datascience/belcorp/repo-pro-12/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/datascience/belcorp/repo-pro-12/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"/Users/datascience/belcorp/repo-pro-12/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/datascience/belcorp/repo-pro-12/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/datascience/belcorp/repo-pro-12/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/datascience/belcorp/repo-pro-12/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/datascience/belcorp/repo-pro-12/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/datascience/belcorp/repo-pro-12/src/views/cargarOpinion.js\";\nimport React, { Component } from 'react';\nimport axios from 'axios';\nimport Button from 'react-bootstrap/Button';\nimport { Redirect, withRouter } from 'react-router-dom';\nimport { createMatcher, getFullFaceDescription, isFaceDetectionModelLoaded, loadModels } from '../api/face';\nimport DrawBox from \"../components/drawBox\";\nimport ShowDescriptors from \"../components/showDescriptors\";\nimport { JSON_PROFILE } from \"../common/profile\";\nvar MaxWidth = 300;\nvar boxColor = '#4da1b8';\n\nvar testImg = require('../img/test.jpg');\n\nvar INIT_STATE = {\n  url: null,\n  imageURL: null,\n  fullDesc: null,\n  imageDimension: null,\n  error: null,\n  loading: false\n};\n\nvar CargarOpinion =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(CargarOpinion, _Component);\n\n  function CargarOpinion(props) {\n    var _this;\n\n    _classCallCheck(this, CargarOpinion);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(CargarOpinion).call(this, props));\n    _this.mounting =\n    /*#__PURE__*/\n    _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee() {\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return loadModels();\n\n            case 2:\n              _context.next = 4;\n              return _this.matcher();\n\n            case 4:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n    _this.matcher =\n    /*#__PURE__*/\n    _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee2() {\n      var faceMatcher;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.t0 = createMatcher;\n              _context2.next = 3;\n              return JSON_PROFILE();\n\n            case 3:\n              _context2.t1 = _context2.sent;\n              _context2.next = 6;\n              return (0, _context2.t0)(_context2.t1);\n\n            case 6:\n              faceMatcher = _context2.sent;\n\n              _this.setState({\n                faceMatcher: faceMatcher\n              });\n\n            case 8:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n\n    _this.handleFileChange =\n    /*#__PURE__*/\n    function () {\n      var _ref3 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee3(event) {\n        return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                _this.resetState();\n\n                if (!(event.target.files.length > 0)) {\n                  _context3.next = 5;\n                  break;\n                }\n\n                _context3.next = 4;\n                return _this.setState({\n                  imageURL: URL.createObjectURL(event.target.files[0]),\n                  loading: true\n                });\n\n              case 4:\n                _this.handleImageChange();\n\n              case 5:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3);\n      }));\n\n      return function (_x) {\n        return _ref3.apply(this, arguments);\n      };\n    }();\n\n    _this.handleURLChange = function (event) {\n      _this.setState({\n        url: event.target.value\n      });\n    };\n\n    _this.handleButtonClick =\n    /*#__PURE__*/\n    _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee4() {\n      var blob;\n      return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              _this.resetState();\n\n              _context4.next = 3;\n              return fetch(_this.state.url).then(function (r) {\n                return r.blob();\n              }).catch(function (error) {\n                return _this.setState({\n                  error: error\n                });\n              });\n\n            case 3:\n              blob = _context4.sent;\n\n              if (!!blob && blob.type.includes('image')) {\n                _this.setState({\n                  imageURL: URL.createObjectURL(blob),\n                  loading: true\n                });\n\n                _this.handleImageChange();\n              }\n\n            case 5:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, _callee4);\n    }));\n    _this.handleImageChange =\n    /*#__PURE__*/\n    _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee5() {\n      var image,\n          _args5 = arguments;\n      return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n        while (1) {\n          switch (_context5.prev = _context5.next) {\n            case 0:\n              image = _args5.length > 0 && _args5[0] !== undefined ? _args5[0] : _this.state.imageURL;\n              _context5.next = 3;\n              return _this.getImageDimension(image);\n\n            case 3:\n              console.log(\"@@@@@ this.state: \", _this.state);\n              _context5.next = 6;\n              return getFullFaceDescription(image, _this.state.WIDTH, _this.state.HEIGHT).then(function (fullDesc) {\n                _this.setState({\n                  fullDesc: fullDesc,\n                  loading: false\n                });\n              });\n\n            case 6:\n            case \"end\":\n              return _context5.stop();\n          }\n        }\n      }, _callee5);\n    }));\n\n    _this.getImageDimension = function (imageURL) {\n      var img = new Image();\n\n      img.onload = function () {\n        var HEIGHT = _this.state.WIDTH * img.height / img.width;\n\n        _this.setState({\n          HEIGHT: HEIGHT,\n          imageDimension: {\n            width: img.width,\n            height: img.height\n          }\n        });\n      };\n\n      img.src = imageURL;\n    };\n\n    _this.handleDescriptorsCheck = function (event) {\n      _this.setState({\n        showDescriptors: event.target.checked\n      });\n    };\n\n    _this.resetState = function () {\n      _this.setState(_objectSpread({}, INIT_STATE));\n    };\n\n    _this.state = {\n      redirect: false\n    };\n\n    _this.setRedirect = function () {\n      _this.setState({\n        redirect: true\n      });\n    };\n\n    _this.renderRedirect = function () {\n      if (_this.state.redirect) {\n        return React.createElement(Redirect, {\n          to: \"/verOpinion\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 147\n          },\n          __self: this\n        });\n      }\n    };\n\n    _this.state = _objectSpread({}, INIT_STATE, {\n      faceMatcher: null,\n      showDescriptors: false,\n      WIDTH: null,\n      HEIGHT: 0,\n      isModelLoaded: !!isFaceDetectionModelLoaded(),\n      caracteristicas: []\n    }); //this.componentDidMount();\n\n    return _this;\n  }\n\n  _createClass(CargarOpinion, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      axios.get('../json/caracteristicasFoto.json').then(function (response) {\n        return _this2.setState({\n          caracteristicas: response.data.data\n        });\n      });\n    }\n  }, {\n    key: \"renderUsers\",\n    value: function renderUsers() {\n      var caracteristicas = this.state.caracteristicas;\n      return caracteristicas.map(function (user) {\n        return React.createElement(\"div\", {\n          key: user.id,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 51\n          },\n          __self: this\n        }, user.first_name, \" \", user.last_name);\n      });\n    }\n  }, {\n    key: \"componentWillMount\",\n    value: function componentWillMount() {\n      this.resetState();\n      var _W = document.documentElement.clientWidth;\n      if (_W > MaxWidth) _W = MaxWidth;\n      this.setState({\n        WIDTH: _W\n      });\n      this.mounting();\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      /*return <div>{ this.renderUsers() }</div>*/\n      var _this$state = this.state,\n          WIDTH = _this$state.WIDTH,\n          HEIGHT = _this$state.HEIGHT,\n          imageURL = _this$state.imageURL,\n          fullDesc = _this$state.fullDesc,\n          faceMatcher = _this$state.faceMatcher,\n          showDescriptors = _this$state.showDescriptors,\n          isModelLoaded = _this$state.isModelLoaded,\n          error = _this$state.error,\n          loading = _this$state.loading;\n      var spinner = React.createElement(\"div\", {\n        style: {\n          margin: 0,\n          color: '#4da1b8',\n          position: 'absolute',\n          top: '50%',\n          left: '50%',\n          transform: 'translate(-50%,-50%)',\n          textShadow: '2px 2px 3px #fff'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 166\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"loading\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 177\n        },\n        __self: this\n      }), React.createElement(\"h3\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 178\n        },\n        __self: this\n      }, \"Processing...\"));\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 183\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        align: \"center\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 184\n        },\n        __self: this\n      }, React.createElement(\"h2\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 185\n        },\n        __self: this\n      }, \"Carga tu opini\\xF3n\"), React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 187\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        style: {\n          position: 'relative',\n          width: WIDTH,\n          height: HEIGHT\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 188\n        },\n        __self: this\n      }, !!imageURL ? React.createElement(\"div\", {\n        style: {\n          position: 'relative'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 196\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        style: {\n          position: 'absolute'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 201\n        },\n        __self: this\n      }, React.createElement(\"img\", {\n        style: {\n          width: WIDTH\n        },\n        src: imageURL,\n        alt: \"imageURL\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 202\n        },\n        __self: this\n      }))) : null, loading ? spinner : null), React.createElement(\"div\", {\n        style: {\n          width: WIDTH,\n          padding: 10,\n          marginTop: 10\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 208\n        },\n        __self: this\n      }, React.createElement(\"p\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 215\n        },\n        __self: this\n      }, \"Cargue una imagen desde su dispositivo\"), React.createElement(\"input\", {\n        id: \"myFileUpload\",\n        type: \"file\",\n        onChange: this.handleFileChange,\n        accept: \".jpg, .jpeg, .png\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 216\n        },\n        __self: this\n      }), React.createElement(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 222\n        },\n        __self: this\n      }), !!showDescriptors ? React.createElement(ShowDescriptors, {\n        fullDesc: fullDesc,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 224\n        },\n        __self: this\n      }) : null)), React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 227\n        },\n        __self: this\n      }, React.createElement(\"h2\", {\n        align: \"center\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 228\n        },\n        __self: this\n      }, \"Descripci\\xF3n\"), React.createElement(\"textarea\", {\n        rows: \"4\",\n        cols: \"50\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 230\n        },\n        __self: this\n      }, \"Me gusto usar el Labial color HD Velvet\"), React.createElement(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 233\n        },\n        __self: this\n      }), React.createElement(\"select\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 234\n        },\n        __self: this\n      }, React.createElement(\"option\", {\n        value: \"volvo\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 235\n        },\n        __self: this\n      }, \"Labial color HD Velvet. Rosa petal\"), React.createElement(\"option\", {\n        value: \"saab\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 236\n        },\n        __self: this\n      }, \"Esmalte profesional 6 en 1 para u\\xF1as. Caf\\xE9 miel\"), React.createElement(\"option\", {\n        value: \"opel\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 237\n        },\n        __self: this\n      }, \"Miss Sexy\"), React.createElement(\"option\", {\n        value: \"audi\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 238\n        },\n        __self: this\n      }, \"Reloj golden Night\")), React.createElement(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 240\n        },\n        __self: this\n      }), React.createElement(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 241\n        },\n        __self: this\n      }), React.createElement(\"style\", {\n        type: \"text/css\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 242\n        },\n        __self: this\n      }, \"\\n                  .btn-flat {\\n                    background-color: gray;\\n                    color: white;\\n                  }\\n              \\n                  .btn-xxl {\\n                    padding: 1rem 1.5rem;\\n                    font-size: 1.5rem;\\n                  }\\n                  \"), this.renderRedirect(), React.createElement(\"button\", {\n        onClick: this.setRedirect,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 257\n        },\n        __self: this\n      }, \"Cargar\"))));\n    }\n  }]);\n\n  return CargarOpinion;\n}(Component);\n\nexport default withRouter(CargarOpinion);","map":{"version":3,"sources":["/Users/datascience/belcorp/repo-pro-12/src/views/cargarOpinion.js"],"names":["React","Component","axios","Button","Redirect","withRouter","createMatcher","getFullFaceDescription","isFaceDetectionModelLoaded","loadModels","DrawBox","ShowDescriptors","JSON_PROFILE","MaxWidth","boxColor","testImg","require","INIT_STATE","url","imageURL","fullDesc","imageDimension","error","loading","CargarOpinion","props","mounting","matcher","faceMatcher","setState","handleFileChange","event","resetState","target","files","length","URL","createObjectURL","handleImageChange","handleURLChange","value","handleButtonClick","fetch","state","then","r","blob","catch","type","includes","image","getImageDimension","console","log","WIDTH","HEIGHT","img","Image","onload","height","width","src","handleDescriptorsCheck","showDescriptors","checked","redirect","setRedirect","renderRedirect","isModelLoaded","caracteristicas","get","response","data","map","user","id","first_name","last_name","_W","document","documentElement","clientWidth","spinner","margin","color","position","top","left","transform","textShadow","padding","marginTop"],"mappings":";;;;;;;;;AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,OAAOC,MAAP,MAAmB,wBAAnB;AAEA,SAAQC,QAAR,EAAkBC,UAAlB,QAAmC,kBAAnC;AACA,SACEC,aADF,EACiBC,sBADjB,EAEEC,0BAFF,EAE8BC,UAF9B,QAGO,aAHP;AAIA,OAAOC,OAAP,MAAoB,uBAApB;AACA,OAAOC,eAAP,MAA4B,+BAA5B;AACA,SAAQC,YAAR,QAA2B,mBAA3B;AAEA,IAAMC,QAAQ,GAAG,GAAjB;AACA,IAAMC,QAAQ,GAAG,SAAjB;;AACA,IAAMC,OAAO,GAAGC,OAAO,CAAC,iBAAD,CAAvB;;AAEA,IAAMC,UAAU,GAAG;AACjBC,EAAAA,GAAG,EAAE,IADY;AAEjBC,EAAAA,QAAQ,EAAE,IAFO;AAGjBC,EAAAA,QAAQ,EAAE,IAHO;AAIjBC,EAAAA,cAAc,EAAE,IAJC;AAKjBC,EAAAA,KAAK,EAAE,IALU;AAMjBC,EAAAA,OAAO,EAAE;AANQ,CAAnB;;IASMC,a;;;;;AACJ,yBAAYC,KAAZ,EAAmB;AAAA;;AAAA;;AACjB,uFAAMA,KAAN;AADiB,UAmCnBC,QAnCmB;AAAA;AAAA;AAAA;AAAA,6BAmCR;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBACHjB,UAAU,EADP;;AAAA;AAAA;AAAA,qBAEH,MAAKkB,OAAL,EAFG;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAnCQ;AAAA,UAwCnBA,OAxCmB;AAAA;AAAA;AAAA;AAAA,6BAwCT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,6BACkBrB,aADlB;AAAA;AAAA,qBACsCM,YAAY,EADlD;;AAAA;AAAA;AAAA;AAAA;;AAAA;AACFgB,cAAAA,WADE;;AAER,oBAAKC,QAAL,CAAc;AAAED,gBAAAA,WAAW,EAAXA;AAAF,eAAd;;AAFQ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAxCS;;AAAA,UA6CnBE,gBA7CmB;AAAA;AAAA;AAAA;AAAA;AAAA,+BA6CA,kBAAMC,KAAN;AAAA;AAAA;AAAA;AAAA;AACjB,sBAAKC,UAAL;;AADiB,sBAEdD,KAAK,CAACE,MAAN,CAAaC,KAAb,CAAmBC,MAAnB,GAA4B,CAFd;AAAA;AAAA;AAAA;;AAAA;AAAA,uBAGT,MAAKN,QAAL,CAAc;AAClBV,kBAAAA,QAAQ,EAAEiB,GAAG,CAACC,eAAJ,CAAoBN,KAAK,CAACE,MAAN,CAAaC,KAAb,CAAmB,CAAnB,CAApB,CADQ;AAElBX,kBAAAA,OAAO,EAAE;AAFS,iBAAd,CAHS;;AAAA;AAOf,sBAAKe,iBAAL;;AAPe;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OA7CA;;AAAA;AAAA;AAAA;AAAA;;AAAA,UAwDnBC,eAxDmB,GAwDD,UAAAR,KAAK,EAAI;AACzB,YAAKF,QAAL,CAAc;AAAEX,QAAAA,GAAG,EAAEa,KAAK,CAACE,MAAN,CAAaO;AAApB,OAAd;AACD,KA1DkB;;AAAA,UA4DnBC,iBA5DmB;AAAA;AAAA;AAAA;AAAA,6BA4DC;AAAA;AAAA;AAAA;AAAA;AAAA;AAClB,oBAAKT,UAAL;;AADkB;AAAA,qBAEDU,KAAK,CAAC,MAAKC,KAAL,CAAWzB,GAAZ,CAAL,CACZ0B,IADY,CACP,UAAAC,CAAC;AAAA,uBAAIA,CAAC,CAACC,IAAF,EAAJ;AAAA,eADM,EAEZC,KAFY,CAEN,UAAAzB,KAAK;AAAA,uBAAI,MAAKO,QAAL,CAAc;AAAEP,kBAAAA,KAAK,EAALA;AAAF,iBAAd,CAAJ;AAAA,eAFC,CAFC;;AAAA;AAEdwB,cAAAA,IAFc;;AAMlB,kBAAI,CAAC,CAACA,IAAF,IAAUA,IAAI,CAACE,IAAL,CAAUC,QAAV,CAAmB,OAAnB,CAAd,EAA2C;AACzC,sBAAKpB,QAAL,CAAc;AACZV,kBAAAA,QAAQ,EAAEiB,GAAG,CAACC,eAAJ,CAAoBS,IAApB,CADE;AAEZvB,kBAAAA,OAAO,EAAE;AAFG,iBAAd;;AAIA,sBAAKe,iBAAL;AACD;;AAZiB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KA5DD;AAAA,UA2EnBA,iBA3EmB;AAAA;AAAA;AAAA;AAAA,6BA2EC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAOY,cAAAA,KAAP,8DAAe,MAAKP,KAAL,CAAWxB,QAA1B;AAAA;AAAA,qBACZ,MAAKgC,iBAAL,CAAuBD,KAAvB,CADY;;AAAA;AAElBE,cAAAA,OAAO,CAACC,GAAR,CAAY,oBAAZ,EAAkC,MAAKV,KAAvC;AAFkB;AAAA,qBAIZpC,sBAAsB,CAAC2C,KAAD,EAAQ,MAAKP,KAAL,CAAWW,KAAnB,EAA0B,MAAKX,KAAL,CAAWY,MAArC,CAAtB,CAAmEX,IAAnE,CAAwE,UAAAxB,QAAQ,EAAI;AACxF,sBAAKS,QAAL,CAAc;AAAET,kBAAAA,QAAQ,EAARA,QAAF;AAAYG,kBAAAA,OAAO,EAAE;AAArB,iBAAd;AACD,eAFK,CAJY;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KA3ED;;AAAA,UAoFnB4B,iBApFmB,GAoFC,UAAAhC,QAAQ,EAAI;AAC9B,UAAIqC,GAAG,GAAG,IAAIC,KAAJ,EAAV;;AACAD,MAAAA,GAAG,CAACE,MAAJ,GAAa,YAAM;AACjB,YAAIH,MAAM,GAAI,MAAKZ,KAAL,CAAWW,KAAX,GAAmBE,GAAG,CAACG,MAAxB,GAAkCH,GAAG,CAACI,KAAnD;;AACA,cAAK/B,QAAL,CAAc;AACZ0B,UAAAA,MAAM,EAANA,MADY;AAEZlC,UAAAA,cAAc,EAAE;AACduC,YAAAA,KAAK,EAAEJ,GAAG,CAACI,KADG;AAEdD,YAAAA,MAAM,EAAEH,GAAG,CAACG;AAFE;AAFJ,SAAd;AAOD,OATD;;AAUAH,MAAAA,GAAG,CAACK,GAAJ,GAAU1C,QAAV;AACD,KAjGkB;;AAAA,UAmGnB2C,sBAnGmB,GAmGM,UAAA/B,KAAK,EAAI;AAChC,YAAKF,QAAL,CAAc;AAAEkC,QAAAA,eAAe,EAAEhC,KAAK,CAACE,MAAN,CAAa+B;AAAhC,OAAd;AACD,KArGkB;;AAAA,UAuGnBhC,UAvGmB,GAuGN,YAAM;AACjB,YAAKH,QAAL,mBAAmBZ,UAAnB;AACD,KAzGkB;;AAAA,UA2GnB0B,KA3GmB,GA2GX;AACNsB,MAAAA,QAAQ,EAAE;AADJ,KA3GW;;AAAA,UA+GnBC,WA/GmB,GA+GL,YAAM;AAClB,YAAKrC,QAAL,CAAc;AACZoC,QAAAA,QAAQ,EAAE;AADE,OAAd;AAGD,KAnHkB;;AAAA,UAqHnBE,cArHmB,GAqHF,YAAM;AACrB,UAAI,MAAKxB,KAAL,CAAWsB,QAAf,EAAyB;AACvB,eAAO,oBAAC,QAAD;AAAU,UAAA,EAAE,EAAC,aAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UAAP;AACD;AACF,KAzHkB;;AAEjB,UAAKtB,KAAL,qBACK1B,UADL;AAEEW,MAAAA,WAAW,EAAE,IAFf;AAGEmC,MAAAA,eAAe,EAAE,KAHnB;AAIET,MAAAA,KAAK,EAAE,IAJT;AAKEC,MAAAA,MAAM,EAAE,CALV;AAMEa,MAAAA,aAAa,EAAE,CAAC,CAAC5D,0BAA0B,EAN7C;AAOE6D,MAAAA,eAAe,EAAE;AAPnB,OAFiB,CAWjB;;AAXiB;AAYlB;;;;wCAEmB;AAAA;;AAClBnE,MAAAA,KAAK,CAACoE,GAAN,CAAU,kCAAV,EACK1B,IADL,CACU,UAAA2B,QAAQ;AAAA,eAAI,MAAI,CAAC1C,QAAL,CAAc;AAAEwC,UAAAA,eAAe,EAAEE,QAAQ,CAACC,IAAT,CAAcA;AAAjC,SAAd,CAAJ;AAAA,OADlB;AAED;;;kCAEa;AAAA,UACJH,eADI,GACgB,KAAK1B,KADrB,CACJ0B,eADI;AAGZ,aAAOA,eAAe,CAACI,GAAhB,CAAqB,UAAAC,IAAI;AAAA,eAC5B;AAAK,UAAA,GAAG,EAAEA,IAAI,CAACC,EAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WAAoBD,IAAI,CAACE,UAAzB,OAAsCF,IAAI,CAACG,SAA3C,CAD4B;AAAA,OAAzB,CAAP;AAGD;;;yCAEoB;AACnB,WAAK7C,UAAL;AACA,UAAI8C,EAAE,GAAGC,QAAQ,CAACC,eAAT,CAAyBC,WAAlC;AACA,UAAIH,EAAE,GAAGjE,QAAT,EAAmBiE,EAAE,GAAGjE,QAAL;AACnB,WAAKgB,QAAL,CAAc;AAAEyB,QAAAA,KAAK,EAAEwB;AAAT,OAAd;AACA,WAAKpD,QAAL;AACD;;;6BA0FQ;AACP;AADO,wBAYH,KAAKiB,KAZF;AAAA,UAGLW,KAHK,eAGLA,KAHK;AAAA,UAILC,MAJK,eAILA,MAJK;AAAA,UAKLpC,QALK,eAKLA,QALK;AAAA,UAMLC,QANK,eAMLA,QANK;AAAA,UAOLQ,WAPK,eAOLA,WAPK;AAAA,UAQLmC,eARK,eAQLA,eARK;AAAA,UASLK,aATK,eASLA,aATK;AAAA,UAUL9C,KAVK,eAULA,KAVK;AAAA,UAWLC,OAXK,eAWLA,OAXK;AAcP,UAAI2D,OAAO,GACP;AACI,QAAA,KAAK,EAAE;AACLC,UAAAA,MAAM,EAAE,CADH;AAELC,UAAAA,KAAK,EAAE,SAFF;AAGLC,UAAAA,QAAQ,EAAE,UAHL;AAILC,UAAAA,GAAG,EAAE,KAJA;AAKLC,UAAAA,IAAI,EAAE,KALD;AAMLC,UAAAA,SAAS,EAAE,sBANN;AAOLC,UAAAA,UAAU,EAAE;AAPP,SADX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAWE;AAAK,QAAA,SAAS,EAAC,SAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAXF,EAYE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,yBAZF,CADJ;AAiBA,aACI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE;AAAK,QAAA,KAAK,EAAC,QAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,+BADF,EAGE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE;AACI,QAAA,KAAK,EAAE;AACLJ,UAAAA,QAAQ,EAAE,UADL;AAELzB,UAAAA,KAAK,EAAEN,KAFF;AAGLK,UAAAA,MAAM,EAAEJ;AAHH,SADX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAOG,CAAC,CAACpC,QAAF,GACG;AACI,QAAA,KAAK,EAAE;AACLkE,UAAAA,QAAQ,EAAE;AADL,SADX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAKE;AAAK,QAAA,KAAK,EAAE;AAAEA,UAAAA,QAAQ,EAAE;AAAZ,SAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE;AAAK,QAAA,KAAK,EAAE;AAAEzB,UAAAA,KAAK,EAAEN;AAAT,SAAZ;AAA8B,QAAA,GAAG,EAAEnC,QAAnC;AAA6C,QAAA,GAAG,EAAC,UAAjD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADF,CALF,CADH,GAUG,IAjBN,EAkBGI,OAAO,GAAG2D,OAAH,GAAa,IAlBvB,CADF,EAqBE;AACI,QAAA,KAAK,EAAE;AACLtB,UAAAA,KAAK,EAAEN,KADF;AAELoC,UAAAA,OAAO,EAAE,EAFJ;AAGLC,UAAAA,SAAS,EAAE;AAHN,SADX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAOE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kDAPF,EAQE;AACI,QAAA,EAAE,EAAC,cADP;AAEI,QAAA,IAAI,EAAC,MAFT;AAGI,QAAA,QAAQ,EAAE,KAAK7D,gBAHnB;AAII,QAAA,MAAM,EAAC,mBAJX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QARF,EAcE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAdF,EAgBG,CAAC,CAACiC,eAAF,GAAoB,oBAAC,eAAD;AAAiB,QAAA,QAAQ,EAAE3C,QAA3B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAApB,GAA8D,IAhBjE,CArBF,CAHF,EA2CE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE;AAAI,QAAA,KAAK,EAAC,QAAV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,0BADF,EAGE;AAAU,QAAA,IAAI,EAAC,GAAf;AAAmB,QAAA,IAAI,EAAC,IAAxB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mDAHF,EAME;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QANF,EAOE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE;AAAQ,QAAA,KAAK,EAAC,OAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,8CADF,EAEE;AAAQ,QAAA,KAAK,EAAC,MAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iEAFF,EAGE;AAAQ,QAAA,KAAK,EAAC,MAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBAHF,EAIE;AAAQ,QAAA,KAAK,EAAC,MAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,8BAJF,CAPF,EAaE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAbF,EAcE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAdF,EAeE;AAAO,QAAA,IAAI,EAAC,UAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,0TAfF,EA6BG,KAAK+C,cAAL,EA7BH,EA8BE;AAAQ,QAAA,OAAO,EAAE,KAAKD,WAAtB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBA9BF,CA3CF,CADF,CADJ;AAkFD;;;;EA7OyBjE,S;;AAgP5B,eAAeI,UAAU,CAACmB,aAAD,CAAzB","sourcesContent":["import React, { Component } from 'react';\nimport axios from 'axios'\nimport Button from 'react-bootstrap/Button';\n\nimport {Redirect, withRouter} from 'react-router-dom';\nimport {\n  createMatcher, getFullFaceDescription,\n  isFaceDetectionModelLoaded, loadModels\n} from '../api/face';\nimport DrawBox from \"../components/drawBox\";\nimport ShowDescriptors from \"../components/showDescriptors\";\nimport {JSON_PROFILE} from \"../common/profile\";\n\nconst MaxWidth = 300;\nconst boxColor = '#4da1b8';\nconst testImg = require('../img/test.jpg');\n\nconst INIT_STATE = {\n  url: null,\n  imageURL: null,\n  fullDesc: null,\n  imageDimension: null,\n  error: null,\n  loading: false\n};\n\nclass CargarOpinion extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      ...INIT_STATE,\n      faceMatcher: null,\n      showDescriptors: false,\n      WIDTH: null,\n      HEIGHT: 0,\n      isModelLoaded: !!isFaceDetectionModelLoaded(),\n      caracteristicas: []\n    };\n    //this.componentDidMount();\n  }\n\n  componentDidMount() {\n    axios.get('../json/caracteristicasFoto.json')\n        .then(response => this.setState({ caracteristicas: response.data.data }))\n  }\n\n  renderUsers() {\n    const { caracteristicas } = this.state\n\n    return caracteristicas.map( user => (\n        <div key={user.id}>{user.first_name} {user.last_name}</div>\n    ))\n  }\n\n  componentWillMount() {\n    this.resetState();\n    let _W = document.documentElement.clientWidth;\n    if (_W > MaxWidth) _W = MaxWidth;\n    this.setState({ WIDTH: _W });\n    this.mounting();\n  }\n\n  mounting = async () => {\n    await loadModels();\n    await this.matcher();\n  };\n\n  matcher = async () => {\n    const faceMatcher = await createMatcher(await JSON_PROFILE());\n    this.setState({ faceMatcher });\n  };\n\n  handleFileChange = async event => {\n    this.resetState();\n    if(event.target.files.length > 0){\n      await this.setState({\n        imageURL: URL.createObjectURL(event.target.files[0]),\n        loading: true\n      });\n      this.handleImageChange();\n    }\n  };\n\n  handleURLChange = event => {\n    this.setState({ url: event.target.value });\n  };\n\n  handleButtonClick = async () => {\n    this.resetState();\n    let blob = await fetch(this.state.url)\n        .then(r => r.blob())\n        .catch(error => this.setState({ error }));\n\n    if (!!blob && blob.type.includes('image')) {\n      this.setState({\n        imageURL: URL.createObjectURL(blob),\n        loading: true\n      });\n      this.handleImageChange();\n    }\n  };\n\n  handleImageChange = async (image = this.state.imageURL) => {\n    await this.getImageDimension(image);\n    console.log(\"@@@@@ this.state: \", this.state)\n\n    await getFullFaceDescription(image, this.state.WIDTH, this.state.HEIGHT).then(fullDesc => {\n      this.setState({ fullDesc, loading: false });\n    });\n  };\n\n  getImageDimension = imageURL => {\n    let img = new Image();\n    img.onload = () => {\n      let HEIGHT = (this.state.WIDTH * img.height) / img.width;\n      this.setState({\n        HEIGHT,\n        imageDimension: {\n          width: img.width,\n          height: img.height\n        }\n      });\n    };\n    img.src = imageURL;\n  };\n\n  handleDescriptorsCheck = event => {\n    this.setState({ showDescriptors: event.target.checked });\n  };\n\n  resetState = () => {\n    this.setState({ ...INIT_STATE });\n  };\n\n  state = {\n    redirect: false\n  }\n\n  setRedirect = () => {\n    this.setState({\n      redirect: true\n    })\n  }\n\n  renderRedirect = () => {\n    if (this.state.redirect) {\n      return <Redirect to='/verOpinion' />\n    }\n  }\n\n  render() {\n    /*return <div>{ this.renderUsers() }</div>*/\n    const {\n      WIDTH,\n      HEIGHT,\n      imageURL,\n      fullDesc,\n      faceMatcher,\n      showDescriptors,\n      isModelLoaded,\n      error,\n      loading\n    } = this.state;\n\n    let spinner = (\n        <div\n            style={{\n              margin: 0,\n              color: '#4da1b8',\n              position: 'absolute',\n              top: '50%',\n              left: '50%',\n              transform: 'translate(-50%,-50%)',\n              textShadow: '2px 2px 3px #fff'\n            }}\n        >\n          <div className=\"loading\" />\n          <h3>Processing...</h3>\n        </div>\n    );\n\n    return (\n        <div>\n          <div align=\"center\">\n            <h2>Carga tu opini&oacute;n</h2>\n\n            <div>\n              <div\n                  style={{\n                    position: 'relative',\n                    width: WIDTH,\n                    height: HEIGHT\n                  }}\n              >\n                {!!imageURL ? (\n                    <div\n                        style={{\n                          position: 'relative'\n                        }}\n                    >\n                      <div style={{ position: 'absolute' }}>\n                        <img style={{ width: WIDTH }} src={imageURL} alt=\"imageURL\" />\n                      </div>\n                    </div>\n                ) : null}\n                {loading ? spinner : null}\n              </div>\n              <div\n                  style={{\n                    width: WIDTH,\n                    padding: 10,\n                    marginTop: 10\n                  }}\n              >\n                <p>Cargue una imagen desde su dispositivo</p>\n                <input\n                    id=\"myFileUpload\"\n                    type=\"file\"\n                    onChange={this.handleFileChange}\n                    accept=\".jpg, .jpeg, .png\"\n                />\n                <br />\n\n                {!!showDescriptors ? <ShowDescriptors fullDesc={fullDesc} /> : null}\n              </div>\n            </div>\n            <div>\n              <h2 align=\"center\">Descripci&oacute;n</h2>\n\n              <textarea rows=\"4\" cols=\"50\">\n            Me gusto usar el Labial color HD Velvet\n            </textarea>\n              <br/>\n              <select>\n                <option value=\"volvo\">Labial color HD Velvet. Rosa petal</option>\n                <option value=\"saab\">Esmalte profesional 6 en 1 para uñas. Café miel</option>\n                <option value=\"opel\">Miss Sexy</option>\n                <option value=\"audi\">Reloj golden Night</option>\n              </select>\n              <br/>\n              <br/>\n              <style type=\"text/css\">\n                {`\n                  .btn-flat {\n                    background-color: gray;\n                    color: white;\n                  }\n              \n                  .btn-xxl {\n                    padding: 1rem 1.5rem;\n                    font-size: 1.5rem;\n                  }\n                  `}\n              </style>\n\n              {this.renderRedirect()}\n              <button onClick={this.setRedirect}>Cargar</button>\n            </div>\n          </div>\n        </div>\n\n\n    );\n  }\n}\n\nexport default withRouter(CargarOpinion);\n"]},"metadata":{},"sourceType":"module"}